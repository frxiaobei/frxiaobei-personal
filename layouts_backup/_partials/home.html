<section class="container centered">
  <div class="about home-animated">
    <!-- 头像 -->
    {{ if and (isset .Site.Params "avatarurl") (not (isset .Site.Params "gravatar")) }}
      {{ with .Site.Params.avatarURL }}
        <div class="avatar animate-item" style="--delay: 0"><img src="{{ . | relURL }}" alt="avatar"></div>
      {{ end }}
    {{ end }}
    {{ with .Site.Params.gravatar }}
      <div class="avatar animate-item" style="--delay: 0"><img src="https://www.gravatar.com/avatar/{{md5 .}}?s=240&d=mp" alt="gravatar"></div>
    {{ end }}

    <!-- 作者名 -->
    <h1 class="animate-item" style="--delay: 1">{{ .Site.Params.author }}</h1>
    
    <!-- 简介 -->
    {{ if reflect.IsSlice .Site.Params.info }}
      <h2 class="animate-item" style="--delay: 2">{{ range .Site.Params.info }}{{ . | markdownify }}<br>{{ end}}</h2>
    {{ else }}
      <h2 class="animate-item" style="--delay: 2">{{ .Site.Params.info | markdownify }}</h2>
    {{ end }}

    <!-- 社交链接 -->
    {{ with .Site.Params.social }}
    <ul class="social-animated">
      {{ $index := 0 }}
      {{ range sort . "weight" }}
        <li class="animate-item" style="--delay: {{ add 3 $index }}">
          {{ if eq .name "公众号" }}
            <!-- 公众号 - 点击显示二维码 -->
            <a href="javascript:void(0)" aria-label="{{ .name }}" class="wechat-trigger" onclick="document.getElementById('wechat-modal').classList.add('show')">
              <img src="/images/gongzhonghao-gray.png" alt="公众号" class="icon-gongzhonghao" />
            </a>
          {{ else }}
            <a href="{{ .url | safeURL }}" aria-label="{{ .name }}" {{ if .rel }}rel="{{ .rel }}"{{ end }} {{ if .target }}target="{{ .target }}"{{ end }} {{ if .type }}type="{{ .type }}"{{ end }}>
              {{ if eq .name "小红书" }}
                <!-- 小红书自定义图标 -->
                <svg class="icon-xiaohongshu" viewBox="0 0 100 100" aria-hidden="true">
                  <rect x="6" y="6" width="88" height="88" rx="18" ry="18" fill="none" stroke="currentColor" stroke-width="5"/>
                  <text x="50" y="42" text-anchor="middle" font-size="22" font-weight="600" fill="currentColor" font-family="system-ui, -apple-system, sans-serif">小红</text>
                  <text x="50" y="72" text-anchor="middle" font-size="28" font-weight="600" fill="currentColor" font-family="system-ui, -apple-system, sans-serif">书</text>
                </svg>
              {{ else if .icon }}
                <i class="{{ .icon }}" aria-hidden="true"></i>
              {{ else }}
                {{ .name }}
              {{ end }}
            </a>
          {{ end }}
        </li>
        {{ $index = add $index 1 }}
      {{ end }}
    </ul>
    {{ end }}
    
    <!-- 公众号二维码弹窗 -->
    <div id="wechat-modal" class="wechat-modal" onclick="this.classList.remove('show')">
      <div class="wechat-modal-content" onclick="event.stopPropagation()">
        <span class="wechat-close" onclick="document.getElementById('wechat-modal').classList.remove('show')">&times;</span>
        <img src="/images/wechat-qr.jpg" alt="公众号二维码" />
        <p>扫码关注公众号</p>
      </div>
    </div>
  </div>

  {{ partialCached "home/extensions.html" . }}
</section>

<style>
  /* 入场动画 */
  .home-animated .animate-item {
    opacity: 0;
    transform: translateY(20px);
    animation: home-fade-in 0.6s ease-out forwards;
    animation-delay: calc(var(--delay) * 0.12s);
  }

  @keyframes home-fade-in {
    from {
      opacity: 0;
      transform: translateY(20px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  /* 头像特殊动画 */
  .home-animated .avatar.animate-item {
    transform: translateY(20px) scale(0.9);
    animation: avatar-fade-in 0.8s ease-out forwards;
  }

  @keyframes avatar-fade-in {
    from {
      opacity: 0;
      transform: translateY(20px) scale(0.9);
    }
    to {
      opacity: 1;
      transform: translateY(0) scale(1);
    }
  }

  /* 社交图标容器 */
  .social-animated {
    display: flex;
    justify-content: center;
    list-style: none;
    padding: 0;
    margin: 0;
  }

  /* 社交图标悬停效果增强 */
  .social-animated li a {
    transition: transform 0.3s ease, opacity 0.3s ease;
  }

  .social-animated li a:hover {
    transform: translateY(-3px);
  }

  /* 小红书自定义图标样式 - 与 fa-2x 图标大小一致 */
  .icon-xiaohongshu {
    width: 2em;
    height: 2em;
    vertical-align: -0.35em;
  }
  
  /* 公众号图标样式 */
  .icon-gongzhonghao {
    width: 2em;
    height: 2em;
    vertical-align: -0.35em;
    /* 浅色模式：加深颜色 */
    filter: brightness(0.3);
  }
  
  /* 深色模式：用 CSS filter 反转+提亮变白 */
  .colorscheme-dark .icon-gongzhonghao {
    filter: invert(1) brightness(10);
  }
  
  @media (prefers-color-scheme: dark) {
    .colorscheme-auto .icon-gongzhonghao {
      filter: invert(1) brightness(10);
    }
  }

  /* 公众号二维码弹窗 */
  .wechat-modal {
    display: none;
    position: fixed;
    inset: 0;
    background: rgba(0, 0, 0, 0.6);
    z-index: 1000;
    justify-content: center;
    align-items: center;
    backdrop-filter: blur(4px);
  }
  
  .wechat-modal.show {
    display: flex;
  }
  
  .wechat-modal-content {
    background: #fff;
    padding: 2rem;
    border-radius: 12px;
    text-align: center;
    position: relative;
    max-width: 280px;
    box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
    animation: modal-pop 0.3s ease-out;
  }
  
  @keyframes modal-pop {
    from {
      opacity: 0;
      transform: scale(0.9);
    }
    to {
      opacity: 1;
      transform: scale(1);
    }
  }
  
  .wechat-modal-content img {
    width: 200px;
    height: 200px;
    border-radius: 8px;
  }
  
  .wechat-modal-content p {
    margin: 1rem 0 0;
    color: #333;
    font-size: 0.95rem;
  }
  
  .wechat-close {
    position: absolute;
    top: 0.5rem;
    right: 0.8rem;
    font-size: 1.5rem;
    color: #999;
    cursor: pointer;
    transition: color 0.2s;
  }
  
  .wechat-close:hover {
    color: #333;
  }
</style>
